---
layout: default
title: 获取视频重定向后的域
---
<h2>{{page.title}}</h2>
<div>播视频，获取重定向后的域，办法很风骚～～ 可以解决像素级访问没有策略文件的问题</div>
<div>仅限debug版flashplayer有效，发布版error.message只有错误码，无更多信息</div>
<br>
<div>来源:http://jessewarden.com/2009/03/handling-crossdomainxml-and-302-redirects-using-netstream.html</div>
<br>
<pre class=" prettyprinted"><span class="keyword"><span class="kwd">try</span></span><span class="pln">
</span><span class="pun">{</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> bit</span><span class="pun">:</span><span class="typ">BitmapData</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="keyword"><span class="kwd">new</span></span><span class="pln"> </span><span class="typ">BitmapData</span><span class="pun">(</span><span class="pln">progressiveVideoPlayer</span><span class="pun">.</span><span class="pln">measuredWidth</span><span class="pun">,</span><span class="pln"> progressiveVideoPlayer</span><span class="pun">.</span><span class="pln">measuredHeight</span><span class="pun">,</span><span class="pln"> </span><span class="identifier"><span class="kwd">false</span></span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x000000</span><span class="pun">);</span><span class="pln">
        bit</span><span class="pun">.</span><span class="identifier2"><span class="pln">draw</span></span><span class="pun">(</span><span class="pln">progressiveVideoPlayer</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="keyword"><span class="kwd">catch</span></span><span class="pun">(</span><span class="pln">error</span><span class="pun">:</span><span class="typ">SecurityError</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
        </span>trace(&quot;error : &quot;+error);<br>		 var address:String, protocol:String = &quot;&quot;;<br>		 try<br>		 {<br>		 	var _arr:Array = error.toString().split(&quot; &quot;)[5].split(&quot;/&quot;);<br>		 	address = _arr[2];<br>			protocol = _arr[0];<br>			var policyFileURL:String = protocol+&quot;//&quot; + address + &quot;/crossdomain.xml&quot;;<br>			Security.loadPolicyFile(policyFileURL);//不会马上执行，在下次需要策略文件时才加载<br>		}<br>		catch(error:Error)<br>		{<br>			trace(error);<br>		}
<span class="pun">}</span></pre>

<p>{{ page.date | date_to_string }}</p>