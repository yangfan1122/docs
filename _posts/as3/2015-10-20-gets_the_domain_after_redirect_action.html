---
layout: default
title: 获取视频重定向后的域
---
<h2>{{page.title}}</h2>
<div>播视频，获取重定向后的域，办法很风骚～～ 可以解决像素级访问没有策略文件的问题</div>
<div>来源:http://jessewarden.com/2009/03/handling-crossdomainxml-and-302-redirects-using-netstream.html</div>
<pre class=" prettyprinted"><span class="keyword"><span class="kwd">try</span></span><span class="pln">
</span><span class="pun">{</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> bit</span><span class="pun">:</span><span class="typ">BitmapData</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="keyword"><span class="kwd">new</span></span><span class="pln"> </span><span class="typ">BitmapData</span><span class="pun">(</span><span class="pln">progressiveVideoPlayer</span><span class="pun">.</span><span class="pln">measuredWidth</span><span class="pun">,</span><span class="pln"> progressiveVideoPlayer</span><span class="pun">.</span><span class="pln">measuredHeight</span><span class="pun">,</span><span class="pln"> </span><span class="identifier"><span class="kwd">false</span></span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x000000</span><span class="pun">);</span><span class="pln">
        bit</span><span class="pun">.</span><span class="identifier2"><span class="pln">draw</span></span><span class="pun">(</span><span class="pln">progressiveVideoPlayer</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="keyword"><span class="kwd">catch</span></span><span class="pun">(</span><span class="pln">error</span><span class="pun">:</span><span class="typ">SecurityError</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> </span><span class="identifier"><span class="pln">list</span></span><span class="pun">:</span><span class="identifier"><span class="typ">Array</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> error</span><span class="pun">.</span><span class="identifier"><span class="pln">toString</span></span><span class="pun">().</span><span class="identifier"><span class="pln">split</span></span><span class="pun">(</span><span class="string"><span class="str">" "</span></span><span class="pun">);</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> swfURL</span><span class="pun">:</span><span class="identifier"><span class="typ">String</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="identifier"><span class="pln">list</span></span><span class="pun">[</span><span class="lit">7</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="identifier"><span class="typ">String</span></span><span class="pun">;</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> </span><span class="identifier2"><span class="pln">domain</span></span><span class="pun">:</span><span class="identifier"><span class="typ">String</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="identifier"><span class="pln">list</span></span><span class="pun">[</span><span class="lit">10</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="identifier"><span class="typ">String</span></span><span class="pun">;</span><span class="pln">
        </span><span class="identifier2"><span class="pln">domain</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="identifier2"><span class="pln">domain</span></span><span class="pun">.</span><span class="identifier"><span class="pln">substring</span></span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="identifier2"><span class="pln">domain</span></span><span class="pun">.</span><span class="identifier2"><span class="pln">length</span></span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> domainList</span><span class="pun">:</span><span class="identifier"><span class="typ">Array</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="identifier2"><span class="pln">domain</span></span><span class="pun">.</span><span class="identifier"><span class="pln">split</span></span><span class="pun">(</span><span class="string"><span class="str">"/"</span></span><span class="pun">);</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> </span><span class="identifier2"><span class="pln">protocol</span></span><span class="pun">:</span><span class="identifier"><span class="typ">String</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> domainList</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="identifier"><span class="typ">String</span></span><span class="pun">;</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> address</span><span class="pun">:</span><span class="identifier"><span class="typ">String</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> domainList</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
        </span><span class="keyword"><span class="kwd">var</span></span><span class="pln"> policyFileURL</span><span class="pun">:</span><span class="identifier"><span class="typ">String</span></span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="identifier2"><span class="pln">protocol</span></span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="string"><span class="str">"//"</span></span><span class="pln"> </span><span class="pun">+</span><span class="pln"> address </span><span class="pun">+</span><span class="pln"> </span><span class="string"><span class="str">"/crossdomain.xml"</span></span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Security</span><span class="pun">.</span><span class="pln">loadPolicyFile</span><span class="pun">(</span><span class="pln">policyFileURL</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre>

<p>{{ page.date | date_to_string }}</p>